Complete rewriting for Elaina due to previous code base deemed not maintainable